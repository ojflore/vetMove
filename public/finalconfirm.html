<!DOCTYPE html>
<html>
<link rel="stylesheet" type="text/css" href="style.css"/>
<script src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Confirmation Page</title>
    <style>

      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        background-color: #4b5320
      }

    </style>

    <script>

    function initMap() {
      console.log("Hello World");
        var url_string = window.location.href;
        var url = new URL(url_string);
        var moverequestid = url.searchParams.get("id");

      //var moverequestid = 2;
      $.ajax({
       type: "GET",
       url: "moverequest?id=" + moverequestid,
       success: function(json) {
         //console.log(JSON.stringify(json));
         if (!json.success) {
           alert(json.message);
         }
         else {//*******This prints the database information we are pulling from
           console.log(JSON.stringify(json));
           console.log(json.data[0].FromZip);
           console.log(json.data[0].ToZip);
           console.log(json.data[0].NumberOfPeople);
           $("#npeople").val(json.data[0].NumberOfPeople);

             var directionsDisplay = new google.maps.DirectionsRenderer;
             var directionsService = new google.maps.DirectionsService;
             var map = new google.maps.Map(document.getElementById('map'),);

             directionsDisplay.setMap(map);

             calculateAndDisplayRoute(directionsService, directionsDisplay, ""+json.data[0].FromZip, ""+json.data[0].ToZip );
             document.getElementById('mode')


         }
       },
       error: function (textStatus, errorThrown) {
         alert("Request failed!");
       }
     });
    }

    </script>


  </head>
  <body>
    <header>
    <img class=logo src="logo.gif" alt="Final Confirmation">
    </header> <br>
<!--Need help on passing information into to these inputs from database -->

<div id="panel">
  <div id="floating-panel">
  <input id="mode" type="hidden" value="DRIVING">Your Travel Confirmation</input><br><br>
  Number of People:<input id="npeople"></input><br>
  Number of rooms : <input id="nroom"></input><br>
  Square Footage : <input id="sqfoot"></input><br>
  Mover ID : <input id="mover"></input><br>
  <button onclick="printpage()">Print this page</button>

  <script>
  function printpage() {
      window.print();
  }
  </script>

  </div>
</div>


    <div id="map"></div>
    <script>



      function calculateAndDisplayRoute(directionsService, directionsDisplay, origin,destination) {
        var selectedMode = document.getElementById('mode').value;
        directionsService.route({
//Need help on passing information from database into origin and desination.//
          origin: origin,  //Origin and desitination can be in either zip or city name.
          destination: destination,

          travelMode: google.maps.TravelMode[selectedMode]
        }, function(response, status) {
          if (status == 'OK') {
            directionsDisplay.setDirections(response);
          } else {
            window.alert('Directions request failed due to ' + status);
          }
        });
      }
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAlT_tN3gQgvp0LXwVbNz6z79MokpIOP5U&callback=initMap">
    </script>
  </body>
</html>
